<div class="container">
  <div class="row">
    <div class="col-12">
      <form class="sign-in-form" [formGroup]="signInForm">
        <h2>Sign in</h2>
        <div class="row-control">
          <mat-form-field [appearance]="'outline'">
            <mat-label>Username</mat-label>
            <input matInput formControlName="username">
          </mat-form-field>
        </div>
        <div class="row-control">
          <mat-form-field [appearance]="'outline'">
            <mat-label>Password</mat-label>
            <input type="password" matInput formControlName="password">
          </mat-form-field>
          <span class="text-danger"
            *ngIf="signInForm.get('password').errors && (signInForm.get('password').dirty || signInForm.get('password').touched)">
            <small *ngIf="signInForm.get('password').errors.required">
              password khong duoc de trong
            </small>
            <small *ngIf="signInForm.get('password').errors.email">
              password sai dinh dang
            </small>
          </span>
        </div>
        <!-- nester group  -->
        <div formGroupName="address">
          <div>
            <div class="row-control">
              <mat-form-field [appearance]="'outline'">
                <mat-label>street</mat-label>
                <input matInput formControlName="street">
              </mat-form-field>
              <span class="text-danger"
                *ngIf="signInForm.get('address.street').errors && (signInForm.get('address.street').dirty || signInForm.get('address.street').touched)">
                <!-- whitespace: return custom validator errors -->
                <small *ngIf="signInForm.get('address.street').errors.whitespace">
                  {{signInForm.get('address.street').errors.whitespace}}
                </small>
              </span>
            </div>
            <div class="row-control">
              <mat-form-field [appearance]="'outline'">
                <mat-label>city</mat-label>
                <input matInput formControlName="city" id="city">
              </mat-form-field>
            </div>
            <div>
              <!-- validation property in  nest group  -->
              <span
                *ngIf="signInForm.get('address.city').errors && (signInForm.get('address.city').dirty || signInForm.get('address.city').touched)"
                class="text-danger">
                <small *ngIf="signInForm.get('address.city')?.errors?.required">
                  city khong duoc de trong
                </small>
                <small *ngIf="signInForm.get('address.city')?.errors?.email">
                  city sai dinh dang
                </small>
              </span>
            </div>
          </div>
        </div>
        <!-- array form  -->
        <div formArrayName="elements">
          <h3>elements</h3>
          <button mat-raised-button color="primary" class="mr-3" (click)="addElement()">
            Add element
          </button>
          <!-- array elements  -->
          <div class="mt-3" *ngFor="let item of elements().controls; let i= index">

            <!-- element group -->
            <div [formGroupName]="i">
              elemet of {{i}}:
              <!-- property of element group -->
              <div class="row-control">
                <mat-form-field [appearance]="'outline'">
                  <mat-label>id</mat-label>
                  <input matInput formControlName="id">
                </mat-form-field>
              </div>

              <div class="row-control">
                <mat-form-field [appearance]="'outline'">
                  <mat-label>name: </mat-label>
                  <input matInput formControlName="name">
                </mat-form-field>
              </div>
              <!-- remove element  -->
              <button mat-raised-button color="primary" class="mr-3" (click)="removeElement(i)">
                remove element
              </button>
            </div>

          </div>
        </div>

        <!-- Async form validator -->
        <div formGroupName="formAsync" class="mt-3">
          <div class="row-control">
            <mat-form-field [appearance]="'outline'">
              <!-- way 1: Directive AsyncValidator -->
              <mat-label>name Async</mat-label>
              <input matInput formControlName="nameAsync" appUserNameApi>
            </mat-form-field>
          </div>
          <div>
            <!-- validation property in  nest group  -->
            <span
              *ngIf="signInForm.get('formAsync.nameAsync').errors && (signInForm.get('formAsync.nameAsync').dirty || signInForm.get('formAsync.nameAsync').touched)"
              class="text-danger">
              <small *ngIf="signInForm.get('formAsync.nameAsync')?.errors?.required">
                name Async khong duoc de trong
              </small>
              <small *ngIf="signInForm.get('formAsync.nameAsync')?.errors?.minLength">
                name Async qua ngan
              </small>
              <small *ngIf="signInForm.get('formAsync.nameAsync')?.errors?.usernameDuplicated">
                name Async đã tồn tại
              </small>
            </span>
          </div>

          <div class="row-control">
            <mat-form-field [appearance]="'outline'">
              <!-- way 2: function AsyncValidator -->
              <mat-label>name Async 2</mat-label>
              <input matInput formControlName="nameAsync2">
            </mat-form-field>
          </div>
          <div>
            <!-- validation property in  nest group  -->
            <span
              *ngIf="signInForm.get('formAsync.nameAsync2').errors && (signInForm.get('formAsync.nameAsync2').dirty || signInForm.get('formAsync.nameAsync2').touched)"
              class="text-danger">
              <small *ngIf="signInForm.get('formAsync.nameAsync2')?.errors?.required">
                name Async 2 khong duoc de trong
              </small>
              <small *ngIf="signInForm.get('formAsync.nameAsync2')?.errors?.minLength">
                name Async 2 qua ngan
              </small>
              <small *ngIf="signInForm.get('formAsync.nameAsync2')?.errors?.usernameDuplicated">
                name Async 2 đã tồn tại
              </small>
            </span>
          </div>
        </div>
      </form>
    </div>
  </div>
  <div class="row mp-3 mt-3">
    <div class="col-12 mb-2">
      <!-- invalid form validatio -->
      <button mat-raised-button color="primary" (click)="viewRegister()" class="mr-3" [disabled]="signInForm.invalid">
        Register
      </button>
      <button mat-raised-button color="warn" (click)="setvalue()"> Set value default</button>
    </div>
    <!-- value reactive form  -->
    <div class="col-12">
      <h4>value reactive form:</h4>
      {{signInForm.value | json}}
    </div>
  </div>
</div>
